
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ecoaldea Tanaj - Mapa Interactivo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="css/estilo.css" />
</head>
<body>
  <header>
    <h1>Mapa Interactivo de Ecoaldea Tanaj</h1>
  </header>
  <div id="map"></div>
  <div id="legend"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script>
    const map = L.map('map').setView([18.51, -89.88], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    const iconos = {
      "Guardia Nacional": L.icon({ iconUrl: 'iconos/punto_1.png', iconSize: [30, 30], iconAnchor: [15, 30] }),
      "Estacionamiento": L.icon({ iconUrl: 'iconos/punto_4.png', iconSize: [30, 30], iconAnchor: [15, 30] })
    };

    Papa.parse('data/Listado_de_Puntos.csv', {
      download: true,
      header: true,
      complete: function(results) {
        results.data.forEach(row => {
          if (!row.Nombre || !row.Latitud || !row.Longitud) return;
          const marker = L.marker([parseFloat(row.Latitud), parseFloat(row.Longitud)], {
            icon: iconos[row.Tipo] || undefined
          }).addTo(map);

          const contenido = `
            <h3>${row.Nombre}</h3>
            <p>${row.Tipo}</p>
            <img src="${row.Imagen || 'https://via.placeholder.com/300x150'}" style="width:100%;border-radius:8px;">
            ${row.URL ? `<a href="${row.URL}" target="_blank">Más información</a>` : ""}
          `;
          marker.bindPopup(contenido);
        });
      }
    });

    // Leyenda básica
    const legend = document.getElementById('legend');
    legend.innerHTML = `
      <h4>Simbología</h4>
      <ul>
        <li><img src="iconos/punto_1.png" width="20"> Guardia Nacional</li>
        <li><img src="iconos/punto_4.png" width="20"> Estacionamiento</li>
      </ul>
    `;
  </script>
</body>
</html>
